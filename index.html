<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Startup Exchange Event Scheduler</title>
    <link rel="icon" type="image/svg+xml" href="https://raw.githubusercontent.com/Muste2/startup-exchange-scheduler/main/talent%20orbit.svg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(ellipse at center, #0f0f23 0%, #000000 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: auto;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 130px 80px, #fff, transparent),
                radial-gradient(2px 2px at 160px 30px, rgba(255,255,255,0.9), transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: twinkle 20s linear infinite;
            z-index: -1;
            pointer-events: none;
        }

        @keyframes twinkle {
            from { transform: translateY(0); }
            to { transform: translateY(-100px); }
        }

        /* Floating planets */
        body::after {
            content: '';
            position: fixed;
            top: 10%;
            right: 5%;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at 30% 30%, #ff6b35, #ff4757, #8e44ad);
            border-radius: 50%;
            opacity: 0.3;
            animation: float 15s ease-in-out infinite;
            z-index: -1;
            pointer-events: none;
            box-shadow: 0 0 50px rgba(255, 107, 53, 0.3);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(180deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(15, 15, 35, 0.95);
            border-radius: 20px;
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.8),
                inset 0 1px 0 rgba(255,255,255,0.1),
                0 0 100px rgba(102, 126, 234, 0.2);
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #8e44ad 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="1" fill="white" opacity="0.3"/><circle cx="80" cy="40" r="0.5" fill="white" opacity="0.5"/><circle cx="40" cy="80" r="0.8" fill="white" opacity="0.4"/><circle cx="90" cy="80" r="0.3" fill="white" opacity="0.6"/></svg>');
            animation: drift 30s linear infinite;
        }

        @keyframes drift {
            from { transform: translateX(0); }
            to { transform: translateX(-100px); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .description {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.9) 0%, rgba(30, 30, 60, 0.9) 100%);
            padding: 25px 30px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
            color: #e0e0ff;
            line-height: 1.6;
            position: relative;
        }

        .description::before {
            content: 'ðŸŒŒ';
            position: absolute;
            top: 25px;
            right: 30px;
            font-size: 2em;
            opacity: 0.3;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.6; }
        }

        .description h3 {
            color: #667eea;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .description ul {
            margin: 10px 0 0 20px;
        }

        .description li {
            margin-bottom: 5px;
        }

        .controls {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.9) 0%, rgba(40, 40, 80, 0.9) 100%);
            padding: 20px 30px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 2px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(5px);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .control-group label {
            font-size: 0.9em;
            color: #b0b0ff;
            font-weight: 600;
        }

        select, input, button {
            padding: 12px 15px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: rgba(15, 15, 35, 0.8);
            color: #e0e0ff;
            backdrop-filter: blur(5px);
        }

        select:focus, input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4);
            background: rgba(20, 20, 50, 0.9);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #8e44ad 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            min-width: 120px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.5),
                0 0 30px rgba(102, 126, 234, 0.3);
        }

        .schedule-grid {
            padding: 30px;
            overflow-x: auto;
            background: rgba(5, 5, 15, 0.5);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
            background: rgba(15, 15, 35, 0.9);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(102, 126, 234, 0.2);
        }

        th, td {
            padding: 15px 12px;
            text-align: left;
            border: 1px solid rgba(102, 126, 234, 0.2);
            color: #e0e0ff;
        }

        th {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.9) 0%, rgba(50, 50, 100, 0.9) 100%);
            font-weight: 600;
            color: #fff;
            position: sticky;
            top: 0;
            z-index: 10;
            text-shadow: 0 0 10px rgba(255,255,255,0.3);
        }

        tr.past-row {
            display: none;
        }

        .time-slot {
            font-weight: 600;
            color: #667eea;
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.8) 0%, rgba(40, 40, 80, 0.8) 100%);
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .company-slot {
            background: linear-gradient(135deg, rgba(25, 25, 50, 0.8) 0%, rgba(35, 35, 70, 0.8) 100%);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border-radius: 8px;
        }

        .company-slot::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 0%, rgba(102, 126, 234, 0.1) 50%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 8px;
        }

        .company-slot:hover {
            background: linear-gradient(135deg, rgba(35, 35, 70, 0.9) 0%, rgba(55, 55, 110, 0.9) 100%);
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .company-slot:hover::before {
            opacity: 1;
        }

        .company-slot.booked {
            background: linear-gradient(135deg, rgba(60, 30, 30, 0.8) 0%, rgba(80, 40, 40, 0.8) 100%);
            cursor: not-allowed;
        }

        .company-slot.booked:hover {
            background: linear-gradient(135deg, rgba(60, 30, 30, 0.8) 0%, rgba(80, 40, 40, 0.8) 100%);
            transform: scale(1);
            box-shadow: none;
        }

        .company-name {
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255,255,255,0.3);
        }

        .company-type {
            font-size: 0.85em;
            color: #fff;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
            padding: 4px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 8px;
            border: 1px solid rgba(102, 126, 234, 0.4);
            backdrop-filter: blur(5px);
        }

        .company-type.startup {
            background: linear-gradient(135deg, rgba(67, 160, 71, 0.3) 0%, rgba(46, 125, 50, 0.3) 100%);
            border: 1px solid rgba(67, 160, 71, 0.4);
            color: #a5d6a7;
        }

        .company-type.vc {
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.3) 0%, rgba(123, 31, 162, 0.3) 100%);
            border: 1px solid rgba(156, 39, 176, 0.4);
            color: #ce93d8;
        }

        .slots-info {
            font-size: 0.9em;
            color: #b0b0ff;
        }

        .slots-available {
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
        }

        .slots-full {
            color: #f87171;
            text-shadow: 0 0 10px rgba(248, 113, 113, 0.5);
        }

        .booked-info {
            font-size: 0.85em;
            color: #fbbf24;
            font-style: italic;
        }

        .booking-modal, .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95) 0%, rgba(30, 30, 60, 0.95) 100%);
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            border: 2px solid rgba(102, 126, 234, 0.3);
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.8),
                0 0 100px rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(15px);
        }

        .confirmation-content {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95) 0%, rgba(30, 30, 60, 0.95) 100%);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            animation: slideUp 0.3s ease;
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.8),
                0 0 100px rgba(102, 126, 234, 0.4);
            border: 2px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(15px);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header h2 {
            margin-bottom: 15px;
            color: #fff;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        .modal-header p {
            color: #b0b0ff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #b0b0ff;
            font-weight: 500;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            background: rgba(20, 20, 50, 0.8);
            color: #e0e0ff;
        }

        .form-group small {
            color: #9090ff;
            font-size: 0.85em;
            margin-top: 3px;
            display: block;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .btn-cancel {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #b0b0ff;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.8) 0%, rgba(30, 30, 60, 0.8) 100%);
            border-radius: 15px;
        }

        /* Confirmation modal styles */
        .confirmation-icon {
            font-size: 60px;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }

        .confirmation-title {
            color: #4ade80;
            font-size: 2em;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }

        .booking-details {
            background: linear-gradient(135deg, rgba(25, 25, 50, 0.9) 0%, rgba(35, 35, 70, 0.9) 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(5px);
        }

        .booking-details h3 {
            color: #667eea;
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #b0b0ff;
        }

        .detail-value {
            color: #fff;
        }

        .screenshot-reminder {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.2) 0%, rgba(255, 152, 0, 0.2) 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid rgba(255, 193, 7, 0.3);
            backdrop-filter: blur(5px);
        }

        .screenshot-reminder p {
            color: #ffc107;
            font-weight: 500;
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
        }

        .screenshot-reminder small {
            color: #ffeb3b;
        }

        .btn-close-confirmation {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #8e44ad 100%);
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 20px;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-close-confirmation:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 8px 30px rgba(102, 126, 234, 0.6),
                0 0 40px rgba(102, 126, 234, 0.3);
        }

        /* Toast notification styles */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95) 0%, rgba(30, 30, 60, 0.95) 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 
                0 5px 25px rgba(0,0,0,0.5),
                0 0 50px rgba(102, 126, 234, 0.3);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 2000;
            border: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(15px);
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.9) 0%, rgba(56, 142, 60, 0.9) 100%);
            border: 1px solid rgba(76, 175, 80, 0.5);
        }

        .toast.error {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.9) 0%, rgba(211, 47, 47, 0.9) 100%);
            border: 1px solid rgba(244, 67, 54, 0.5);
        }

        .toast.warning {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.9) 0%, rgba(245, 124, 0, 0.9) 100%);
            border: 1px solid rgba(255, 152, 0, 0.5);
        }

        /* Additional space elements */
        .space-decoration {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: twinkle-stars 4s ease-in-out infinite;
        }

        @keyframes twinkle-stars {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .modal-content, .confirmation-content {
                margin: 10px;
                width: calc(100% - 20px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš€ Startup Exchange Event Scheduler</h1>
            <p>Talent Orbit Career Fair - Interview Scheduling System</p>
        </div>
        
        <div class="description">
            <h3>About Startup Exchange</h3>
            <p>An interactive networking experience inspired by the World CafÃ© model, designed to connect students with the startup and venture capital world. Through a series of rotating, small-group conversations, students will:</p>
            <ul style="margin: 10px 0 0 20px;">
                <li>Learn firsthand about the realities of launching and growing startups</li>
                <li>Explore career paths and job opportunities in the startup ecosystem</li>
                <li>Gain feedback and insights that can shape their own entrepreneurial ideas</li>
            </ul>
            <p style="margin-top: 10px;">Each table hosts a unique themeâ€”ranging from early-stage challenges to scaling strategies, investing, and startup careersâ€”creating space for open dialogue, practical advice, and authentic connections between students, founders, and investors.</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>Select Day</label>
                <select id="daySelect">
                    <option value="day1">Day 1 - October 2</option>
                    <option value="day2">Day 2 - October 3</option>
                </select>
            </div>
        </div>

        <div class="schedule-grid" id="scheduleGrid">
            <div class="loading">Loading schedule...</div>
        </div>
    </div>

    <div class="booking-modal" id="bookingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Book Interview Slot</h2>
                <p id="modalInfo"></p>
            </div>
            <form id="bookingForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="studentName" required>
                </div>
                
                <div class="form-group">
                    <label>Student ID *</label>
                    <input type="text" id="studentId" required>
                </div>
                
                <div class="form-group">
                    <label>Student iMail *</label>
                    <input type="email" id="studentEmail" required pattern=".*@[iI][mM][aA][iI][lL]\.[sS][uU][nN][wW][aA][yY]\.[eE][dD][uU]\.[mM][yY]$">
                    <small>Must end with @imail.sunway.edu.my</small>
                </div>
                
                <div class="form-group">
                    <label>School *</label>
                    <select id="studentSchool" required>
                        <option value="">Select your school</option>
                        <option value="FASS">Faculty of Arts & Social Sciences (FASS)</option>
                        <option value="FET">Faculty of Engineering & Technology (FET)</option>
                        <option value="FMLS">Faculty of Medical & Life Sciences (FMLS)</option>
                        <option value="SAE">School of American Education (SAE)</option>
                        <option value="SOE">School of Education (SOE)</option>
                        <option value="SHTM">School of Hospitality and Tourism Management (SHTM)</option>
                        <option value="SMS">School of Mathematical Sciences (SMS)</option>
                        <option value="SBS">Sunway Business School (SBS)</option>
                        <option value="Others">Others (specify below)</option>
                    </select>
                </div>
                
                <div class="form-group" id="otherSchoolGroup" style="display: none;">
                    <label>Specify Other School</label>
                    <input type="text" id="otherSchool">
                </div>
                
                <div class="form-group">
                    <label>Course of Study *</label>
                    <input type="text" id="studentCourse" required placeholder="E.g., BSc (Hons) Business Management">
                </div>
                
                <div class="form-group">
                    <label>Year of Study *</label>
                    <select id="studentYear" required>
                        <option value="">Select year</option>
                        <option value="Year 1">Year 1</option>
                        <option value="Year 2">Year 2</option>
                        <option value="Year 3">Year 3</option>
                        <option value="Year 4">Year 4</option>
                        <option value="Final Year">Final Year</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Contact Number *</label>
                    <input type="tel" id="studentPhone" required>
                </div>
                
                <div class="form-group">
                    <label>Personal Email</label>
                    <input type="email" id="personalEmail">
                    <small>In case you are unreachable at your Student iMail</small>
                </div>
                
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
                    <button type="submit">Confirm Booking</button>
                </div>
            </form>
        </div>
    </div>

    <div class="confirmation-modal" id="confirmationModal">
        <div class="confirmation-content">
            <div class="confirmation-icon">âœ…</div>
            <h2 class="confirmation-title">Booking Confirmed!</h2>
            
            <div class="booking-details">
                <h3>ðŸ“‹ Your Interview Details</h3>
                <div class="detail-row">
                    <span class="detail-label">Date:</span>
                    <span class="detail-value" id="confirmDate"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Time:</span>
                    <span class="detail-value" id="confirmTime"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Company:</span>
                    <span class="detail-value" id="confirmCompany"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Table:</span>
                    <span class="detail-value" id="confirmTable"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Student Name:</span>
                    <span class="detail-value" id="confirmName"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Student ID:</span>
                    <span class="detail-value" id="confirmId"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">School:</span>
                    <span class="detail-value" id="confirmSchool"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Course:</span>
                    <span class="detail-value" id="confirmCourse"></span>
                </div>
            </div>
            
            <div class="screenshot-reminder">
                <p>ðŸ“¸ Please take a screenshot of this confirmation!</p>
                <small>You'll need to show this at your interview.</small>
            </div>
            
            <button class="btn-close-confirmation" onclick="closeConfirmation()">Close</button>
        </div>
    </div>

    <script>
        // Configuration - Replace with your Google Sheets Web App URL
        const SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwnN6EbYwCBegCTw1c5z7IXk1qtUhK4q03jLMq4AxAhH04fDvqbRTuGgkq4JyiPf7no/exec';
        
        // Company data
        const companies = {
            day1: [
                { name: "Block 71", type: "vc", table: 1 },
                { name: "TheHive Sea", type: "vc", table: 2 },
                { name: "Sunway iLabs", type: "vc", table: 3 },
                { name: "Arclab", type: "startup", table: 4 },
                { name: "Ourteam.ai", type: "startup", table: 5 },
                { name: "Growth Charger", type: "vc", table: 6 },
                { name: "AI engineer", type: "startup", table: 7 },
                { name: "gentech AI", type: "startup", table: 8 },
                { name: "Urban Farm Tech", type: "startup", table: 9 },
                { name: "Gobi Partners", type: "vc", table: 10 }
            ],
            day2: [
                { name: "Aonic", type: "startup", table: 1 },
                { name: "TheHive Sea", type: "vc", table: 2 },
                { name: "Sunway iLabs", type: "vc", table: 3 },
                { name: "SpeedHome", type: "startup", table: 4 },
                { name: "Arclab", type: "startup", table: 5 },
                { name: "Ourteam.ai", type: "startup", table: 6 },
                { name: "Growth Charger", type: "vc", table: 7 },
                { name: "Aurellia", type: "startup", table: 8 },
                { name: "Buzz", type: "startup", table: 9 },
                { name: "AI engineer", type: "startup", table: 10 },
                { name: "Urban Farm Tech", type: "startup", table: 11 },
                { name: "Gobi Partners", type: "vc", table: 12 }
            ]
        };

        // Bookings cache
        let bookingsCache = {};
        let lastFetchTime = 0;
        const CACHE_DURATION = 30000; // 30 seconds cache

        // Toast notification function
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function getTimeSlots() {
            let slots = [];
            let currentTime = new Date();
            currentTime.setHours(12, 30, 0); // Start at 12:30 PM
            const endTime = new Date();
            endTime.setHours(16, 0, 0); // End at 4:00 PM
            
            while (currentTime < endTime) {
                let startHour = currentTime.getHours();
                let startMin = currentTime.getMinutes();
                
                let endSlotTime = new Date(currentTime);
                endSlotTime.setMinutes(endSlotTime.getMinutes() + 20);
                
                let endHour = endSlotTime.getHours();
                let endMin = endSlotTime.getMinutes();
                
                let startStr = `${startHour.toString().padStart(2, '0')}:${startMin.toString().padStart(2, '0')}`;
                let endStr = `${endHour.toString().padStart(2, '0')}:${endMin.toString().padStart(2, '0')}`;
                
                slots.push(`${startStr} - ${endStr}`);
                
                currentTime.setMinutes(currentTime.getMinutes() + 20);
            }
            
            return slots;
        }


        function isSlotPassed(slotTime, selectedDay) {
            const now = new Date();
            const [startTime] = slotTime.split(' - ');
            const [hours, minutes] = startTime.split(':').map(Number);
            

            const slotDate = new Date();
            if (selectedDay === 'day1') {
                slotDate.setMonth(9, 2); // October 2
            } else {
                slotDate.setMonth(9, 3); // October 3
            }
            slotDate.setHours(hours, minutes, 0, 0);
            

            const slotEndTime = new Date(slotDate);
            slotEndTime.setMinutes(slotEndTime.getMinutes() + 20);
            
            return now > slotEndTime;
        }


        async function loadFromSheets(forceRefresh = false) {
            const now = Date.now();
            
            // Use cache if available and not expired
            if (!forceRefresh && Object.keys(bookingsCache).length > 0 && (now - lastFetchTime) < CACHE_DURATION) {
                return true;
            }
            
            try {
                const response = await fetch(SHEETS_URL, {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (data.success) {
                    bookingsCache = data.bookings || {};
                    lastFetchTime = now;
                    return true;
                } else {
                    throw new Error(data.error || 'Load failed');
                }
            } catch (error) {
                console.error('Load error:', error);
                showToast('Could not connect to booking system', 'error');
                return false;
            }
        }

        // Save booking to Google Sheets
        async function saveToSheets(bookingKey, booking) {
            try {
                const [day, slotIndex, table] = bookingKey.split('_');
                const companyList = companies[day];
                const company = companyList.find(c => c.table === parseInt(table));
                const companyName = company ? company.name : '';
                
                booking.company = companyName;
                
                const payload = {
                    action: 'add',
                    bookingKey: bookingKey,
                    booking: booking,
                    timestamp: new Date().toISOString()
                };
                
                const response = await fetch(SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });
                
                // Update local cache
                if (!bookingsCache[bookingKey]) {
                    bookingsCache[bookingKey] = [];
                }
                bookingsCache[bookingKey].push(booking);
                
                return true;
            } catch (error) {
                console.error('Save error:', error);
                showToast('Booking saved with warning: sync issue', 'warning');
                return false;
            }
        }

        // Load and display schedule
        async function loadSchedule() {
            await loadFromSheets();
            
            const day = document.getElementById('daySelect').value;
            const timeSlots = getTimeSlots();
            const companyList = companies[day];
            
            let html = '<table>';
            html += '<thead><tr><th>Time Slot</th>';
            
            companyList.forEach(company => {
                html += `<th>Table ${company.table}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            timeSlots.forEach((slot, slotIndex) => {
                const isPassed = isSlotPassed(slot, day);
                const rowClass = isPassed ? 'past-row' : '';
                
                html += `<tr class="${rowClass}">`;
                html += `<td class="time-slot">${slot}</td>`;
                
                companyList.forEach(company => {
                    const bookingKey = `${day}_${slotIndex}_${company.table}`;
                    const currentBookings = bookingsCache[bookingKey] || [];
                    const isBooked = currentBookings.length > 0;
                    
                    html += `<td class="company-slot ${isBooked ? 'booked' : ''}" 
                             onclick="${isBooked ? '' : `openBookingModal('${day}', ${slotIndex}, ${company.table})`}">`;
                    html += `<div class="company-name">${company.name}</div>`;
                    html += `<div class="company-type ${company.type}">${company.type.toUpperCase()}</div>`;
                    html += `<div class="slots-info">`;
                    if (isBooked) {
                        html += `<span class="slots-full">âœ— Booked</span>`;
                        if (currentBookings[0]) {
                            html += `<div class="booked-info">by ${currentBookings[0].name}</div>`;
                        }
                    } else {
                        html += `<span class="slots-available">âœ“ Available</span>`;
                    }
                    html += `</div>`;
                    html += `</td>`;
                });
                html += `</tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('scheduleGrid').innerHTML = html;
        }

  
        document.getElementById('studentSchool').addEventListener('change', function() {
            const otherGroup = document.getElementById('otherSchoolGroup');
            const otherInput = document.getElementById('otherSchool');
            if (this.value === 'Others') {
                otherGroup.style.display = 'block';
                otherInput.required = true;
            } else {
                otherGroup.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        });

  
        function openBookingModal(day, slotIndex, tableNumber) {
            const companyList = companies[day];
            const company = companyList.find(c => c.table === tableNumber);
            const timeSlots = getTimeSlots();
            const bookingKey = `${day}_${slotIndex}_${tableNumber}`;
            const currentBookings = bookingsCache[bookingKey] || [];
            
            if (currentBookings.length > 0) {
                showToast('This slot is already booked. Please choose another time.', 'error');
                return;
            }
            
            const dateStr = day === 'day1' ? 'October 2' : 'October 3';
            
            document.getElementById('modalInfo').innerHTML = 
                `<strong>Company:</strong> ${company.name}<br>
                 <strong>Date:</strong> ${dateStr}<br>
                 <strong>Time:</strong> ${timeSlots[slotIndex]}<br>
                 <strong>Table:</strong> ${tableNumber}`;
            
            document.getElementById('bookingModal').style.display = 'flex';
            document.getElementById('bookingForm').dataset.bookingKey = bookingKey;
            document.getElementById('bookingForm').dataset.day = day;
            document.getElementById('bookingForm').dataset.slotIndex = slotIndex;
            document.getElementById('bookingForm').dataset.table = tableNumber;
        }

       
        function closeModal() {
            document.getElementById('bookingModal').style.display = 'none';
            document.getElementById('bookingForm').reset();
            document.getElementById('otherSchoolGroup').style.display = 'none';
        }

        function showConfirmation(bookingData) {
            const day = bookingData.day;
            const slotIndex = bookingData.slotIndex;
            const tableNumber = bookingData.table;
            const companyList = companies[day];
            const company = companyList.find(c => c.table === parseInt(tableNumber));
            const timeSlots = getTimeSlots();
            const dateStr = day === 'day1' ? 'October 2' : 'October 3';
            
            document.getElementById('confirmDate').textContent = dateStr;
            document.getElementById('confirmTime').textContent = timeSlots[slotIndex];
            document.getElementById('confirmCompany').textContent = company.name;
            document.getElementById('confirmTable').textContent = tableNumber;
            document.getElementById('confirmName').textContent = bookingData.name;
            document.getElementById('confirmId').textContent = bookingData.studentId;
            document.getElementById('confirmSchool').textContent = bookingData.school;
            document.getElementById('confirmCourse').textContent = bookingData.course;
            
            document.getElementById('confirmationModal').style.display = 'flex';
        }

       
        function closeConfirmation() {
            document.getElementById('confirmationModal').style.display = 'none';
            loadSchedule(); // Refresh the schedule
        }

        
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const bookingKey = this.dataset.bookingKey;
            const day = this.dataset.day;
            const slotIndex = this.dataset.slotIndex;
            const table = this.dataset.table;
            
            const schoolValue = document.getElementById('studentSchool').value;
            const finalSchool = schoolValue === 'Others' 
                ? document.getElementById('otherSchool').value 
                : schoolValue;
            
            const booking = {
                name: document.getElementById('studentName').value,
                studentId: document.getElementById('studentId').value,
                email: document.getElementById('studentEmail').value,
                school: finalSchool,
                course: document.getElementById('studentCourse').value,
                year: document.getElementById('studentYear').value,
                phone: document.getElementById('studentPhone').value,
                personalEmail: document.getElementById('personalEmail').value,
                timestamp: new Date().toISOString()
            };
            
            // Save to sheets
            await saveToSheets(bookingKey, booking);
            
            // Close booking modal
            closeModal();
            
            // Show confirmation modal
            showConfirmation({
                ...booking,
                day: day,
                slotIndex: slotIndex,
                table: table
            });
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            loadSchedule();
            
            // Auto-refresh every 60 seconds
            setInterval(() => {
                loadFromSheets(true).then(() => loadSchedule());
            }, 60000);
        });
        
        document.getElementById('daySelect').addEventListener('change', function() {
            loadSchedule();
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target === document.getElementById('bookingModal')) {
                closeModal();
            }
            if (e.target === document.getElementById('confirmationModal')) {
                closeConfirmation();
            }
        });

        function addSpaceDecorations() {
            for (let i = 0; i < 20; i++) {
                const star = document.createElement('div');
                star.className = 'space-decoration';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                document.body.appendChild(star);
            }
        }

        window.addEventListener('load', addSpaceDecorations);
    </script>
</body>
</html>
